---
title: "Field Code state to state network graph"
---

We are going to work with a network graph that shows the level of state to state borrowings of codes of civil procedure in the nineteenth century. Notice that the data for code-to-code borrowings are also available in this repository.

```{r setup, include=FALSE}
library(tidyverse)
library(tidygraph)
library(ggraph)
library(igraph)
options(scipen = 999999999)
```

## Loading the data and creating the graph

Networks are defined by a data frame of edges and (optionally) a data frame of nodes. An edge table has two columns of node names showing a connection between them. A node table has one column of node names. Optionally, both can include additional columns of metadata specific to nodes or edges.

```{r, message=FALSE}
edges_df <-read_csv("field-states-edges.csv")
nodes_df <-read_csv("field-states-nodes.csv")
```

We can turn those data frames into a graph (the mathematical term for a network).

```{r}
g <- graph_from_data_frame(edges_df, directed = TRUE, vertices = nodes_df)
g <- g %>% as_tbl_graph()
g
```

We can get a quick look at the graph using `plot()`

```{r}
plot(g)
```

## Measuring the centrality of nodes

The importance, called *centrality*, of a node can be measured with various algorithms. These can be added to the graph object as node attributes using `mutate()`. Note that below we pull out the nodes data frame to inspect it and do not save the results back to our graph object `g` just yet.

Look at the definitions given in *The Historian's Macroscope* and follow the links to the documentation for the various functions using `?centrality`. Also use your intution from the visualization of the graph above. What measure of centrality is most appropriate for this graph?

```{r}
centrality <- g %>% 
  mutate(c_authority = centrality_authority() %>% round(4),
         c_betweenness = centrality_betweenness() %>% round(4),
         c_closeness = centrality_closeness() %>% round(4),
         c_eigen = centrality_eigen() %>% round(4),
         c_hub = centrality_hub() %>% round(4),
         c_pagerank = centrality_pagerank() %>% round(4),
         c_communicability = centrality_communicability() %>% round(4)) %>% 
  as_data_frame(what = "vertices") 
centrality
```

